# D-Talks 사용자 대시보드

온라인 커뮤니케이션의 유해성을 모니터링하고 보호하는 Streamlit 애플리케이션입니다.

## 🏗️ 프로젝트 구조

```
dtalks_user_app/
├── main.py              # 메인 애플리케이션
├── config.py            # 설정 및 상수
├── database.py          # 데이터베이스 연결 및 관리
├── analyzer.py          # 텍스트 분석 (OpenAI 연동)
├── utils.py             # 유틸리티 함수들
├── simulation.py        # 시뮬레이션 데이터 생성
├── data_processor.py    # 데이터 처리 및 분석
├── components.py        # UI 컴포넌트들
├── charts.py            # 차트 생성 함수들
├── requirements.txt     # 필요한 패키지 목록
└── README.md           # 이 파일
```

## 📋 주요 기능

### 1. 게시글 보호 모드
- 댓글 유해성 분석을 통한 게시글 단위 온도 계산
- 유해온도에 따른 자동 블러링 (39°C 이상)
- 인스타그램 스타일 UI/UX
- 실시간 온도계 시각화

### 2. 주간 리포트
- 개인 커뮤니케이션 패턴 분석
- KPI 대시보드 (작성 수, 리라이팅 제안/수락률 등)
- 7일간 혐오/조롱 표현율 추이
- 평균 유해온도 모니터링

## 🚀 설치 및 실행

### 1. 의존성 설치
```bash
pip install -r requirements.txt
```

### 2. 환경 변수 설정 (선택사항)
```bash
# OpenAI API (실제 분석용)
export OPENAI_API_KEY="your_openai_api_key"

# Oracle DB 연결 (선택사항)
export ORA_HOST="your_oracle_host"
export ORA_USER="your_oracle_user"
export ORA_PASSWORD="your_oracle_password"
export ORA_SERVICE="your_oracle_service"
export ORA_PORT="1521"
```

### 3. 애플리케이션 실행
```bash
.streamlit run main.py
```

## 🔧 모듈별 설명

### `config.py`
- 색상 팔레트, 상수, 기본 설정값 정의
- 전체 애플리케이션에서 사용하는 공통 설정

### `database.py`
- Oracle 데이터베이스 연결 관리
- 테이블 자동 생성 및 초기화
- 게시글/댓글/이벤트 데이터 조회 함수

### `analyzer.py`
- OpenAI Moderation API를 통한 텍스트 유해성 분석
- API 키가 없을 경우 시뮬레이션 분석 제공
- 독성, 혐오, 조롱 등 다차원 점수 계산

### `utils.py`
- 온도 매핑, 심각도 계산 등 핵심 유틸리티
- 긍정/중성 표현 감지 (오탐 억제)
- 색상 변환, 배지 결정 로직

### `simulation.py`
- DB 연결이 없을 때 사용할 시뮬레이션 데이터 생성
- 현실적인 패턴을 모방한 댓글/이벤트 데이터

### `data_processor.py`
- 댓글 분석 결과 집계 및 게시글 온도 계산
- 주간 리포트용 KPI 및 일별 통계 생성
- 유해성 사유별 정규화 처리

### `components.py`
- Streamlit UI 컴포넌트들
- 온도계 (아이콘형/3D형), 인스타그램 카드, KPI 테이블
- HTML/CSS 기반 커스텀 컴포넌트

### `charts.py`
- Plotly 기반 인터랙티브 차트 생성
- 표현율/온도 분리형 차트 및 결합형 차트
- 임계값 표시, 그라데이션 효과

### `main.py`
- 메인 애플리케이션 진입점
- 사이드바 설정, 탭 구성, 전체 레이아웃 관리
- 각 모듈을 조합하여 완전한 대시보드 구현

## 🎨 주요 특징

### 온도 매핑 시스템
- 댓글 단위: 독성 점수(0-1) → 온도(36.5-40.0°C)
- 게시글 단위: 유해발언 비율 1%p당 +0.035°C

### 보호 모드
- 주의: 37.8°C 이상 (오탐 억제 로직 적용)
- 경고: 39.0°C 이상 (무조건 표시)
- 블러링: 39.0°C 이상 게시글 자동 흐림 처리

### 오탐 억제
- 긍정적 키워드 감지 ("최고", "좋다", "감사" 등)
- 짧은 중성 표현 필터링 (".", "ㅋㅋ", "ㅠㅠ" 등)
- 다차원 점수 임계값 조합 검증

## 🔗 데이터 소스

1. **시뮬레이션 모드** (기본)
   - 실제 DB 없이도 모든 기능 테스트 가능
   - 현실적인 패턴의 시뮬레이션 데이터

2. **DB 연결 모드**
   - Oracle 데이터베이스 연동
   - `IG_COMMENTS`, `EVENTS` 테이블 자동 생성
   - 실제 운영 데이터 분석

## 📊 사용법

1. **사이드바에서 설정 조정**
   - 사용자 ID, 임계값, 데이터 소스 선택
   - 온도계 표시 모드 및 크기 조정

2. **게시글 보기 탭**
   - 게시글 선택 또는 시뮬레이션 데이터 확인
   - 유해온도에 따른 자동 보호 모드 동작
   - 댓글별 상세 분석 결과 확인

3. **주간 리포트 탭**
   - 개인 커뮤니케이션 패턴 분석
   - 표현율 추이 및 온도 변화 모니터링
   - 분리/결합 차트 모드 선택

## 🛠️ 커스터마이징

- `config.py`에서 색상, 임계값, 상수 조정
- `components.py`에서 UI 스타일 커스터마이징
- `analyzer.py`에서 분석 로직 수정
- `charts.py`에서 차트 디자인 변경

## 📝 라이선스

이 프로젝트는 교육 및 연구 목적으로 제작되었습니다.